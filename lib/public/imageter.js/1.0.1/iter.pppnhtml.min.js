var configp={app_style:1,app_location:2,service:"",creative:{type:0,w:0,h:0,code:"0",click:"",material:"",click:"",third_show_url:"",third_click_url:"",cookiemapping_url:"",cb_code:"",cb_show_monitor:""},ads_handler:"s",news_handler:"x",record_handler:"x",timer:1000};var isxad;var isIE=!!window.ActiveXObject;var appUrl="";var scriptUrlSub="iter.pppnhtml.js";var closeWidth=40;var closeHeight=13;var logoWidth=24;var logoHeight=18;var biglogoWidth=131;var biglogoHeight=18;var appWidth=0;var appHeight=0;var appLoc=11;var scriptUrlHeader="";var allUrlHeader="";var hasMinimize=false;var ev={bind:function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}else{a["on"+c]=b}}},remove:function(a,c,b){if(a.removeEventListener){a.removeEventListener(c,b,false)}else{if(a.datachEvent){a.datachEvent("on"+c,b)}else{a["on"+c]=null}}},importFile:function(c,a){var d;switch(c){case"js":d=document.createElement("script");d.src=a;d.charset="utf-8";d.type="text/javascript";break;case"css":d=document.createElement("link");d.type="text/css";d.rel="stylesheet";d.href=a;break}var b=document.getElementsByTagName("head")[0];b.appendChild(d)}};function checkClickUrl(d){var c=0;if(d.length>0){var b=d.indexOf("url=");var a=d.length;if(b<0){c=0}else{if((b+4)==a){c=0}else{c=1}}}else{c=0}return c}function getAdsClickUrl(d){var c="";if(d.length>0){var b=d.indexOf("&url=");var a=d.length;if(b>0){c=d.substring(b+5,a)}}return c}function getMonitorUrl(c){var b="";if(c.length>0){var a=c.indexOf("&url=");if(a>0){b=c.substring(0,a)}}return b}function checkImfImtUrl(a,g){if(a.indexOf(g)<0){return}var c=a.indexOf(">");if(c<=0){return}var h=a.substring(1,c);var b=a.substring(c+1,a.length);var j=1000;var f=500;var d=new Array();d=h.split("-");for(i=0;i<d.length;i++){var e=d[i];if(i==1&&e.length>0&&!isNaN(e)){j=parseInt(e)}if(i==2&&e.length>0&&!isNaN(e)){f=parseInt(e)}}return{lowTime:j,mastIime:f,httpStr:b}}var imfCount=0;function sendReqMsg(p){var b="<im";var s=p+"";if(s.length==0){return}var a=new Array();a=s.split(";");var h="";var u="";for(i=0;i<a.length;i++){var g=a[i];if(g.length>0&&g.toLowerCase()!="http://"&&g.indexOf(b)<0){ev.importFile("js",g)}if(g.indexOf("<imf")>=0){h=g+""}if(g.indexOf("<imt")>=0){u=g+""}}if(h.length>0){var c=1000;var r=500;var q="";var o=1000;var l=500;var k="";var e=checkImfImtUrl(h,"<imf");if("undefined"!=typeof(e)){c=e.lowTime;r=e.mastIime;q=e.httpStr}else{return}var t=checkImfImtUrl(u,"<imt");if("undefined"!=typeof(t)){o=t.lowTime;l=t.mastIime;k=t.httpStr}if(q.length>0){if(k.length>0){var m=document.createElement("iframe");m.id="tmphIfrm"+imfCount;imfCount=imfCount+1;m.style.display="none";m.src=q;m.width="0px";m.height="0px";isx.container.appendChild(m);var n=c+parseInt(r*Math.random());var j=setInterval(function(){m.src=k;clearInterval(j)},n);var f=c+o+parseInt((r+l)*Math.random());var d=setInterval(function(){clearInterval(d);m.src="about:blank"},f)}else{var m=document.createElement("iframe");m.id="tmphIfrm"+imfCount;imfCount=imfCount+1;m.style.display="none";m.src=q;isx.container.appendChild(m);var n=c+parseInt(r*Math.random());var j=setInterval(function(){m.src="about:blank";clearInterval(j)},n)}}}}var jsloader={getIFrameDOM:function(a){return document.getElementById(a).contentDocument||document.frames[a].document},loadjsext:function(d,a,f,e,c){var g=document.createElement("div");g.id="isxpcrt00";var h=document.createElement("iframe");h.id="isx-p-f1";h.scrolling="no";h.width=f+"px";h.height=e+"px";h.marginWidth="0px";h.marginHeight="0px";h.frameBorder="0px";h.style.cssText="border:0px;background:none repeat scroll 0% 0% transparent;margin:0px;padding:0px;top:0px;left:0px;";var b='<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></head><body style="padding:0;margin:0;border:0;background:transparent;" scroll="no">'+c+a+"</body></html>";h.onload=h.onreadystatechange=function(){if(h.readyState&&h.readyState!="loaded"&&h.readyState!="complete"){return}else{h.onload=h.onreadystatechange=null;var j=jsloader.getIFrameDOM("isx-p-f1");if(navigator.userAgent.indexOf("Firefox")>0||navigator.userAgent.indexOf("Chrome")>0){j.open();j.write(b);j.close()}else{j.write(b)}}};d.appendChild(g);g.appendChild(h);jsloader.loadjsext1(d,f,e)},loadjsext1:function(a,c,b){var d=document.createElement("div");d.id="isxpcrt01";d.style.display="none";var e=document.createElement("iframe");e.id="isx-p-f2";e.scrolling="no";e.width=c+"px";e.height=b+"px";e.marginWidth="0px";e.marginHeight="0px";e.frameBorder="0px";e.style.cssText="border:0px;background:none repeat scroll 0% 0% transparent;margin:0px;padding:0px;top:0px;left:0px;";a.appendChild(d);d.appendChild(e)}};var cachep={fetchAds:function(){isxad=new ISXAd(configp.creative)}};var ISXAd=function(a){this.container=isx.container;this.adData=a;this.contents=null;this.closes=null;this.logos=null;this.biglogos=null;this.timerId=null;this.init()};ISXAd.prototype={constructor:ISXAd,init:function(){var a=this;a.createApps()},createApps:function(){var h=this;var l=h.adData;var f=document.createElement("div");var g=document.createElement("div");var b="",k="";var m=(l.material+"").toLowerCase();if(m.indexOf("http://null.jpg")>=0){isx.container.style.display="none";return}if(h.adData.third_show_url){sendReqMsg(h.adData.third_show_url)}if(h.adData.cookiemapping_url){sendReqMsg(h.adData.cookiemapping_url)}f.id="isx-contents-wrapper-p";g.id="isx-close-wrapper-p";appWidth=l.w;appHeight=l.h;appLoc=configp.app_location;isx.container.appendChild(f);if(l.type==0){b=(l.click||"");var c=getAdsClickUrl(b);if(c.length>0){k+="<a class='large-image' target='_blank' href='"+c+"'><img src='"+l.material+"' alt=''  width='"+l.w+"' height='"+l.h+"' border='0px'/></a>"}else{k+="<img src='"+l.material+"' alt=''  width='"+l.w+"' height='"+l.h+"' border='0px'/>"}f.innerHTML=k}else{if(l.type==1){}else{if(l.type==2){b=(l.click||"");var c=getAdsClickUrl(b);if(c.length>0){}k+='<div id=pppobj style="text-align:left;position:absolute;z-index:2;width:'+l.w+"px;height:"+l.h+'px;">';k+='<object id="afg-adloader" width="'+l.w+'" height="'+l.h+'"  align="middle" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=10,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000">';k+='<param value="always" name="allowScriptAccess"/><param value="'+l.material+'" name="movie"/><param value="high" name="quality"/><param value="opaque" name="wmode"/><param value="high" name="quality"><param value="#F1F1F1" name="bgcolor"/>';k+='<embed width="'+l.w+'" height="'+l.h+'" align="middle" pluginspage="http://www.adobe.com/go/getflashplayer"  type="application/x-shockwave-flash" allowscriptaccess="always" wmode="opaque"  bgcolor="#F1F1F1" quality="high" src="'+l.material+'"></object>';k+="</div>";if(c.length>0){k+="<a id=pppa href='"+c+"' target='_blank' style='display:block;width:"+l.w+"px;height:"+l.h+"px;position:absolute; z-index:999;background:#000;filter:alpha(opacity=0);-moz-opacity:0;opacity: 0'></a>"}f.innerHTML=k}else{if(l.type==3){if(l.material&&l.material.toLowerCase().indexOf("http://")==0){if(typeof refurl!="undefined"&&l.material.toLowerCase().indexOf("(url)")>0){l.material=l.material.replace("(url)",refurl)}var a='<iframe src="'+l.material+'" scrolling="no" height="'+l.h+'" width="'+l.w+'" frameborder="0" border="0" marginwidth="0" marginheight="0"></iframe>';k+=a;f.innerHTML=k}}else{if(l.type==4){if(l.code&&l.code.toLowerCase().indexOf("http://")==0){if(typeof refurl!="undefined"&&l.code.toLowerCase().indexOf("(url)")>0){alert(UrlEncode(refurl));l.code=l.code.replace("(url)",UrlEncode(refurl))}var a='<iframe src="'+l.code+'" scrolling="no" height="'+l.h+'" width="'+l.w+'" frameborder="0" border="0" marginwidth="0" marginheight="0"></iframe>';k+=a;f.innerHTML=k}else{var o="";if(l.cb_code){configp.creative.h=l.h;configp.creative.w=l.w;configp.creative.cb_code=l.cb_code+"";if(l.cb_show_monitor){configp.creative.cb_show_monitor=l.cb_show_monitor}var j=Date.parse(new Date());o="<script type='text/javascript' src='"+scriptUrlHeader+"iter.cbppp.js?v="+j+"'><\/script>"}jsloader.loadjsext(f,l.code,l.w,l.h,o)}}}}}}var d="width:"+(l.w+0)+"px;height:"+(l.h+0)+"px;";var n=h.getLocXY(appWidth+20,appHeight+20);f.style.left=n.locX+"px";f.style.top=n.locY+"px";f.style.cssText="position: absolute;z-index:2147483500;float:right;margin-left:0px !important;text-align:left;overflow:hidden;border:0px solid #BBB;display:block;"+d;closeHtml='<a title="关闭" href="javascript:;" class="isx-close">&nbsp;&nbsp;&nbsp;</a>';g.innerHTML=closeHtml;g.style.left=(n.locX+appWidth-closeWidth-3)+"px";g.style.top=(n.locY+appHeight-closeHeight-3)+"px";var e=" background-color:#F1F3F5;position:absolute;filter:alpha(Opacity=90);-moz-opacity:0.9;opacity: 0.9;background:url("+allUrlHeader+"/images/isx-close.png) no-repeat;color: #555555;font:normal 10px/12px Arial,Microsoft Yahei;";e=e+"text-align: center;z-index:2147483647;border: 0px solid #BBB;";e=e+"width:"+closeWidth+"px;height:"+closeHeight+"px;";g.style.cssText=e;isx.container.appendChild(g);h.contents=f;h.closes=g;h.relocXY();h.bindClosesEvents();h.bindAdsEvents();h.bindLogoEvents()},getLocXY:function(c,d){var b=document.documentElement.scrollTop||document.body.scrollTop;var e=document.documentElement.scrollLeft||document.body.scrollLeft;var a=0,f=0;if(appLoc==10){a=e;f=document.documentElement.clientHeight-d+b}else{if(appLoc==11){a=(document.documentElement.clientWidth-c+e);f=(document.documentElement.clientHeight-d+b)}else{if(appLoc==12){a=(document.documentElement.clientWidth-c)/2+e;f=(document.documentElement.clientHeight-d)/2+b}else{if(appLoc==13){a=e;f=b}else{if(appLoc==14){a=document.documentElement.clientWidth-c+e;f=b}else{a=document.documentElement.clientWidth-c+e;f=document.documentElement.clientHeight-d+b}}}}}return{locX:a,locY:f}},relocXY:function(){var e=this;var b=document.documentElement.scrollTop||document.body.scrollTop;var c=document.documentElement.scrollLeft||document.body.scrollLeft;var a=0,d=0;if(appLoc==10){a=c;d=document.documentElement.clientHeight-e.contents.offsetHeight+b}else{if(appLoc==11){a=document.documentElement.clientWidth-e.contents.offsetWidth+c;d=document.documentElement.clientHeight-e.contents.offsetHeight+b}else{if(appLoc==12){a=(document.documentElement.clientWidth-e.contents.offsetWidth)/2+c;d=(document.documentElement.clientHeight-e.contents.offsetHeight)/2+b}else{if(appLoc==13){a=c;d=b}else{if(appLoc==14){a=document.documentElement.clientWidth-e.contents.offsetWidth+c;d=b}else{a=document.documentElement.clientWidth-e.contents.offsetWidth+c;d=document.documentElement.clientHeight-e.contents.offsetHeight+b}}}}}e.contents.style.left=(a-0)+"px";e.contents.style.top=(d-0)+"px";e.closes.style.left=(a+appWidth-closeWidth-3)+"px";e.closes.style.top=(d+3)+"px"},closeApp:function(){var c=this;c.contents.style.display="none";c.closes.style.display="none";if(document.getElementById("pppobj")){var b=document.getElementById("pppobj");b.style.display="none"}if(document.getElementById("pppa")){var a=document.getElementById("pppa");a.style.display="none"}},bindLogoEvents:function(){var a=this;ev.bind(a.contents,"mouseover",function(){clearTimeout(a.timerId)});ev.bind(a.contents,"mouseout",function(){clearTimeout(a.timerId)})},removeLogoEvents:function(){var a=this;ev.remove(a.contents,"mouseover",function(){clearTimeout(a.timerId)});ev.remove(a.contents,"mouseout",function(){clearTimeout(a.timerId)})},bindClosesEvents:function(){var a=this;ev.bind(a.closes,"mousedown",function(){a.closeApp()})},bindAdsEvents:function(){var c=this;var b=c.contents.children;if(b.length>0){if(b.length==2){var a=b[1];ev.bind(a,"mousedown",function(){c.sendAdsClickMsg()})}else{var a=b[0];ev.bind(a,"mousedown",function(){c.sendAdsClickMsg()})}}},sendAdsClickMsg:function(){var c=this;var a=c.adData.click+"";var b=getMonitorUrl(a);if(b.length>0){ev.importFile("js",b)}if(c.adData.third_click_url){sendReqMsg(c.adData.third_click_url)}}};var mixConfig=function(e){if(e&&typeof e=="object"){for(var b in e){configp[b]=e[b]}var d=configp.service.toLowerCase();var a=d.indexOf("/actions");if(a>=0){appUrl=d.substring(0,a)}else{appUrl=d}}else{return}};var isx={init:function(){if(typeof configp.isp=="undefined"){return}appLoc=configp.app_location;var b=document.getElementsByTagName("script");for(var d=0,a=b.length;d<a;d++){var g=b[d];var e=g.src;if("undefined"!=typeof(e)){var c=e.indexOf(scriptUrlSub);if(c>0){scriptUrlHeader=e.substring(0,c);allUrlHeader=scriptUrlHeader.substring(0,scriptUrlHeader.length-1);var f=allUrlHeader.lastIndexOf("/");allUrlHeader=allUrlHeader.substring(0,f)}}}isx.createContainer()},createContainer:function(){var a=document.createElement("div");a.id="isx-plugin-container-p";var b=isx.getLocXY(configp.creative.w,configp.creative.h);a.style.left=b.locX+"px";a.style.top=b.locY+"px";a.style.cssText="border: 0px solid #BBB;";isx.container=a;document.body.children&&document.body.insertBefore(a,document.body.lastChild.nextSibling)},getLocXY:function(c,d){var b=document.documentElement.scrollTop||document.body.scrollTop;var e=document.documentElement.scrollLeft||document.body.scrollLeft;var a=0,f=0;if(appLoc==10){a=e;f=document.documentElement.clientHeight-d+b}else{if(appLoc==11){a=(document.documentElement.clientWidth-c+e);f=(document.documentElement.clientHeight-d+b)}else{if(appLoc==12){a=(document.documentElement.clientWidth-c)/2+e;f=(document.documentElement.clientHeight-d)/2+b}else{if(appLoc==13){a=e;f=b}else{if(appLoc==14){a=document.documentElement.clientWidth-c+e;f=b}else{a=document.documentElement.clientWidth-c+e;f=document.documentElement.clientHeight-d+b}}}}}return{locX:a,locY:f}}};var readylist=[];var run=function(){for(var a=0;a<readylist.length;a++){readylist[a]&&readylist[a]()}};var doScrollCheck=function(){try{document.documentElement.doScroll("left")}catch(a){}run()};document.DomReady=function(a){if(document.readyState==="complete"){readylist.push(a);run();return}if(readylist.push(a)>1){return}if(document.addEventListener){return document.addEventListener("DOMContentLoaded",run,false)}if(isIE){doScrollCheck()}};function init(b){var a=b;if(typeof a!="undefined"){mixConfig(a)}else{return}isx.init();cachep.fetchAds()}window.isx_config_p=function(a){init(a);ev.bind(document,"resize",function(){isxad.relocXY()});ev.bind(window,"resize",function(){isxad.relocXY()});ev.bind(document,"scroll",function(){isxad.relocXY()});ev.bind(window,"scroll",function(){isxad.relocXY()})};